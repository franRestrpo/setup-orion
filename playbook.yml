---
- name: Orion Design - Modern Infrastructure Setup
  hosts: servers
  become: true
  gather_facts: true

  pre_tasks:
    - name: Verificar/Instalar Python3 en el destino (Raw)
      raw: test -e /usr/bin/python3 || (apt -y update && apt install -y python3-minimal)
      changed_when: false
      failed_when: false

  roles:
    - common
    - docker

  post_tasks:
    - name: "Informe Final: Resumen de Versiones"
      ansible.builtin.debug:
        msg: |
          --------------------------------------------------
          âœ… Despliegue de Infraestructura Completado
          --------------------------------------------------
          - Git: {{ installed_git_version | default('No detectado') }}
          - Docker: {{ installed_docker_version | default('No detectado') }}
          - Docker Compose: {{ installed_docker_compose_version | default('No detectado') }}
          --------------------------------------------------